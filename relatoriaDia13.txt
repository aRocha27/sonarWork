
Perfeito. Vou fazer exatamente o que pediste: analisar os dois mini-relat√≥rios, cruz√°-los com o que realmente aconteceu no chat e no c√≥digo, eliminar imprecis√µes, e entregar um relat√≥rio di√°rio √∫nico, coerente, acad√©mico e fiel ao trabalho real do Dia 13.

‚ö†Ô∏è Nota importante
Nos textos que enviaste h√° algumas imprecis√µes factuais (ex.: m√©tricas por classe, mAP ‚âà 0.65, classifica√ß√£o direta por YOLO ainda ativa). Eu corrijo isso abaixo para n√£o criares problemas numa avalia√ß√£o.

Relat√≥rio Di√°rio de Progresso
Projeto: Dete√ß√£o de Objetos em Imagens de Sonar com YOLOv8 e Classifica√ß√£o H√≠brida
Dia 13
1. Contexto e Objetivo da Sess√£o

O objetivo geral do projeto √© desenvolver um sistema robusto para dete√ß√£o autom√°tica de objetos em imagens de sonar, seguido de classifica√ß√£o da intensidade de reflex√£o ac√∫stica em tr√™s n√≠veis: low, medium e high.

Nesta sess√£o, o foco esteve em fechar a fase de remodula√ß√£o arquitetural do projeto e em validar experimentalmente a abordagem h√≠brida, ap√≥s a conclus√£o do treino do modelo YOLOv8 em modo single-class.

2. Decis√£o Arquitetural Consolidada

Durante esta sess√£o foi confirmada e implementada definitivamente a principal decis√£o arquitetural do projeto:

O YOLOv8 √© utilizado exclusivamente como detetor bin√°rio (object vs background).

A classifica√ß√£o low / medium / high n√£o √© aprendida pelo YOLO, sendo realizada a posteriori, atrav√©s de an√°lise da intensidade do eco dentro de cada bounding box.

Esta decis√£o foi motivada por:

A natureza cont√≠nua da intensidade ac√∫stica (n√£o categ√≥rica).

A confus√£o sistem√°tica observada quando se tentou treinar m√∫ltiplas classes de reflex√£o.

A necessidade de explicabilidade f√≠sica da classifica√ß√£o.

Esta reformula√ß√£o representa uma melhoria estrutural do projeto, tornando-o mais robusto, control√°vel e academicamente defens√°vel.

3. Treino do Modelo YOLO

Foi conclu√≠do o treino de um modelo YOLOv8n, com as seguintes configura√ß√µes:

Resolu√ß√£o: 640 √ó 640

Epochs: 200

Batch size: 8

Device: CPU

Classes: 1 (object)

O treino decorreu corretamente ap√≥s:

Normaliza√ß√£o de todas as labels para a classe 0

Remo√ß√£o de ficheiros .cache antigos

Corre√ß√£o de inconsist√™ncias no data.yaml

Resultados finais (valida√ß√£o):

mAP@0.5 ‚âà 0.57

Recall ‚âà 0.58

Precision ‚âà 0.54

Estes valores s√£o considerados adequados tendo em conta:

O tamanho reduzido do dataset

A elevada complexidade visual das imagens de sonar

O facto de o modelo ser usado apenas como detetor de regi√µes de interesse

4. Infer√™ncia YOLO e Avalia√ß√£o Visual

Foi realizada infer√™ncia sobre o conjunto de valida√ß√£o, permitindo confirmar que:

As bounding boxes s√£o corretamente posicionadas na maioria dos casos

Os principais erros est√£o associados a:

reverbera√ß√£o

reflex√µes fortes no fundo

ru√≠do t√≠pico de sonar

Estas falhas foram consideradas expect√°veis e relevantes para discuss√£o futura.

5. Desenvolvimento e Valida√ß√£o do Pipeline H√≠brido

Foi implementado e testado um pipeline h√≠brido completo (infer_hybrid.py), integrando:

Dete√ß√£o de objetos com YOLOv8

Extra√ß√£o da regi√£o da bounding box

C√°lculo de uma m√©trica de intensidade ac√∫stica

Classifica√ß√£o final em low / medium / high

Evolu√ß√£o do m√©todo de intensidade

Durante a sess√£o foram testadas v√°rias abordagens, incluindo:

percentis (p95, p90)

top-k mean

intensidade HSV

canal vermelho direto

Estas abordagens mostraram-se sens√≠veis a picos e satura√ß√£o do colormap, levando a classifica√ß√µes enviesadas para high.

Solu√ß√£o final adotada

Foi definida uma m√©trica baseada em densidade e domin√¢ncia do eco forte, usando:

red_excess = max(0, R ‚àí max(G, B))

Score h√≠brido:

score
=
0.7
‚ãÖ
mean(red_excess)
+
0.3
‚ãÖ
frac_strong
score=0.7‚ãÖmean(red_excess)+0.3‚ãÖfrac_strong

onde frac_strong representa a fra√ß√£o de pixels com eco forte dentro da ROI.

Esta m√©trica revelou-se:

robusta a ru√≠do

coerente com a perce√ß√£o visual

capaz de distinguir efetivamente low, medium e high

Calibra√ß√£o final

Ap√≥s an√°lise do conjunto de valida√ß√£o, foram definidos empiricamente:

t_low = 0.02

t_high = 0.025

Estes valores produzem uma separa√ß√£o equilibrada das classes e refletem corretamente a escala reduzida do score.

6. Estado Final do Dia

‚úÖ Arquitetura h√≠brida definida e implementada
‚úÖ Treino YOLO conclu√≠do com sucesso
‚úÖ Infer√™ncia YOLO validada visualmente
‚úÖ Pipeline h√≠brido funcional e calibrado
‚úÖ Classifica√ß√£o low / medium / high coerente
‚úÖ C√≥digo estabilizado (sem erros estruturais)


8. Dificuldades Encontradas e Solu√ß√µes Adotadas

Ao longo da sess√£o de trabalho do Dia 13 foram identificadas v√°rias dificuldades t√©cnicas e conceptuais, t√≠picas de projetos aplicados em vis√£o computacional com dados reais de sonar. Estas dificuldades foram analisadas de forma sistem√°tica e conduziram a melhorias significativas no pipeline final.

8.1 Problemas na Classifica√ß√£o Direta por YOLO

Inicialmente, foi considerada a utiliza√ß√£o do YOLOv8 para classificar diretamente os n√≠veis de reflex√£o (low / medium / high). No entanto, esta abordagem revelou-se inadequada devido a:

fronteiras sem√¢nticas pouco definidas entre classes de intensidade

confus√£o frequente entre medium e high

m√∫ltiplas dete√ß√µes do mesmo objeto com classes diferentes

aus√™ncia de liga√ß√£o f√≠sica direta entre a classe prevista e a intensidade real do eco

Solu√ß√£o:
A abordagem foi reformulada para um modelo h√≠brido, onde o YOLO √© utilizado apenas para dete√ß√£o de regi√µes de interesse (object vs background), sendo a classifica√ß√£o de intensidade realizada externamente atrav√©s de processamento dedicado.

8.2 Satura√ß√£o de M√©tricas Baseadas em Pico de Intensidade

Durante o desenvolvimento do pipeline h√≠brido, foram testadas m√©tricas baseadas em percentis elevados (p95, p90) e em top-k mean. Estas m√©tricas apresentaram comportamento indesejado:

satura√ß√£o frequente do score para valores pr√≥ximos de 1.0

classifica√ß√£o sistem√°tica de quase todos os objetos como high

elevada sensibilidade a poucos pixels muito intensos (ru√≠do ou speckle)

Este efeito foi agravado pela utiliza√ß√£o de imagens com colormap falso-cor, onde picos isolados podem atingir valores m√°ximos mesmo em regi√µes globalmente fracas.

Solu√ß√£o:
As m√©tricas baseadas em picos foram abandonadas em favor de uma m√©trica baseada em densidade e energia global do eco, reduzindo a influ√™ncia de valores extremos.

8.3 Limita√ß√µes do Canal HSV e do Canal Vermelho Direto

Foram tamb√©m avaliadas abordagens baseadas no canal V do espa√ßo HSV e no canal vermelho direto do RGB. Estas solu√ß√µes mostraram-se insuficientes porque:

o canal V tende a saturar em v√°rias cores do colormap

zonas predominantemente verdes ou amarelas podem apresentar valores elevados no canal R

a simples presen√ßa de poucos pixels vermelhos levava a classifica√ß√µes incorretas como high

Solu√ß√£o:
Foi introduzido o conceito de excesso de vermelho (red_excess), definido como:

red_excess
=
max
‚Å°
(
0
,
ùëÖ
‚àí
max
‚Å°
(
ùê∫
,
ùêµ
)
)
red_excess=max(0,R‚àímax(G,B))

Esta medida quantifica apenas a domin√¢ncia real do vermelho, eliminando contribui√ß√µes de cores interm√©dias e reduzindo falsos positivos.

8.4 Classifica√ß√£o Incoerente Devido a Normaliza√ß√£o Local

Verificou-se ainda que a normaliza√ß√£o local por bounding box conduzia a scores artificialmente elevados, uma vez que cada objeto era avaliado apenas relativamente a si pr√≥prio.

Solu√ß√£o:
A normaliza√ß√£o local foi desativada, garantindo que os scores permanecem compar√°veis entre diferentes objetos e imagens, preservando a interpreta√ß√£o global da intensidade ac√∫stica.

8.5 Defini√ß√£o Final da M√©trica H√≠brida

Ap√≥s v√°rias itera√ß√µes experimentais, foi adotada a seguinte m√©trica h√≠brida final:

score
=
0.7
‚ãÖ
mean(red_excess)
+
0.3
‚ãÖ
frac_strong
score=0.7‚ãÖmean(red_excess)+0.3‚ãÖfrac_strong

onde frac_strong representa a fra√ß√£o de pixels cujo red_excess ultrapassa um limiar definido.

Esta m√©trica permite:

distinguir picos isolados de manchas densas

penalizar reflex√µes fracas com poucos pixels intensos

alinhar a classifica√ß√£o com a perce√ß√£o visual e interpreta√ß√£o f√≠sica do sonar

8.6 Calibra√ß√£o dos Thresholds

Devido √† natureza conservadora da m√©trica adotada, os valores absolutos do score s√£o baixos. Ap√≥s an√°lise emp√≠rica do conjunto de valida√ß√£o, foram definidos:

t_low = 0.02

t_high = 0.025

Estes valores garantem uma separa√ß√£o coerente entre low, medium e high, sem enviesamento sistem√°tico para nenhuma classe.

8.7 Corre√ß√£o de Erros de Implementa√ß√£o

Durante o desenvolvimento do c√≥digo foram ainda identificados e corrigidos v√°rios erros t√©cnicos, incluindo:

uso de vari√°veis n√£o inicializadas (UnboundLocalError)

chamadas de fun√ß√µes fora do contexto correto

conflitos de nomes entre vari√°veis e imports

erros de path e execu√ß√£o em ambiente PowerShell

A resolu√ß√£o destes problemas contribuiu para a estabiliza√ß√£o final do pipeline.

S√≠ntese

As dificuldades encontradas ao longo desta sess√£o foram essenciais para a evolu√ß√£o do projeto, conduzindo a decis√µes mais fundamentadas e a um pipeline final mais robusto, explic√°vel e adequado ao dom√≠nio do sonar.

Em vez de comprometer o projeto, estes desafios permitiram consolidar uma abordagem h√≠brida que supera as limita√ß√µes da classifica√ß√£o direta por redes neuronais em dados ac√∫sticos complexos.

8. Pr√≥ximos Passos

Avalia√ß√£o quantitativa dos resultados (Dia 14)

Sele√ß√£o de exemplos representativos (bons e falhas)

Implementa√ß√£o de um m√©todo cl√°ssico baseline (Dia 15)

Compara√ß√£o entre abordagens

Escrita das sec√ß√µes Resultados e Discuss√£o